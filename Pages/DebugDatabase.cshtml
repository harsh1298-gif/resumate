@page
@model DebugDatabaseModel
@{
    ViewData["Title"] = "Database Debug";
}

<div class="container mt-5">
    <h2>Database Debug Information</h2>
    
    <div class="card mt-4">
        <div class="card-header">
            <h4>Database Connection</h4>
        </div>
        <div class="card-body">
            <p><strong>Database:</strong> @Model.DatabaseName</p>
            <p><strong>Can Connect:</strong> @Model.CanConnect</p>
            <p><strong>Tables:</strong> @string.Join(", ", Model.TableNames)</p>
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            <h4>AspNetUsers</h4>
        </div>
        <div class="card-body">
            <p><strong>Count:</strong> @Model.UserCount</p>
            @if (Model.Users.Any())
            {
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Email</th>
                            <th>User Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var user in Model.Users)
                        {
                            <tr>
                                <td>@user.Id</td>
                                <td>@user.Email</td>
                                <td>@user.UserName</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            <h4>Applicants</h4>
        </div>
        <div class="card-body">
            <p><strong>Count:</strong> @Model.ApplicantCount</p>
            @if (Model.Applicants.Any())
            {
                <table class="table table-striped">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Full Name</th>
                            <th>Email</th>
                            <th>User ID</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var app in Model.Applicants)
                        {
                            <tr>
                                <td>@app.Id</td>
                                <td>@app.FullName</td>
                                <td>@(Model.Users.FirstOrDefault(u => u.Id == app.UserId)?.Email ?? "N/A")</td>
                                <td>@app.UserId</td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>

    <div class="card mt-4">
        <div class="card-header">
            <h4>Logs</h4>
        </div>
        <div class="card-body">
            <pre>@string.Join("\n", Model.Logs)</pre>
        </div>
    </div>
</div>
